"use strict";(self.webpackChunksayaku=self.webpackChunksayaku||[]).push([[4160],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=a.createContext({}),c=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,b=d["".concat(i,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(b,s(s({ref:t},u),{},{components:n})):a.createElement(b,s({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=d;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:r,s[1]=l;for(var c=2;c<o;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4526:function(e,t,n){n.r(t),n.d(t,{assets:function(){return N},contentTitle:function(){return h},default:function(){return A},frontMatter:function(){return v},metadata:function(){return y},toc:function(){return w}});var a=n(3117),r=n(102),o=n(7294),s=n(3905),l=n(4334),i=n(2389),c=n(7392),u=n(7094),p=n(2466),d="tabList__CuJ",m="tabItem_LNqP";function b(e){var t,n,r=e.lazy,s=e.block,i=e.defaultValue,b=e.values,k=e.groupId,f=e.className,g=o.Children.map(e.children,(function(e){if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),x=null!=b?b:g.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),v=(0,c.l)(x,(function(e,t){return e.value===t.value}));if(v.length>0)throw new Error('Docusaurus error: Duplicate values "'+v.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var h=null===i?i:null!=(t=null!=i?i:null==(n=g.find((function(e){return e.props.default})))?void 0:n.props.value)?t:g[0].props.value;if(null!==h&&!x.some((function(e){return e.value===h})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+h+'" but none of its children has the corresponding value. Available values are: '+x.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=(0,u.U)(),N=y.tabGroupChoices,w=y.setTabGroupChoices,T=(0,o.useState)(h),A=T[0],j=T[1],S=[],E=(0,p.o5)().blockElementScrollPositionUntilNextRender;if(null!=k){var R=N[k];null!=R&&R!==A&&x.some((function(e){return e.value===R}))&&j(R)}var O=function(e){var t=e.currentTarget,n=S.indexOf(t),a=x[n].value;a!==A&&(E(t),j(a),null!=k&&w(k,String(a)))},D=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a,r=S.indexOf(e.currentTarget)+1;n=null!=(a=S[r])?a:S[0];break;case"ArrowLeft":var o,s=S.indexOf(e.currentTarget)-1;n=null!=(o=S[s])?o:S[S.length-1]}null==(t=n)||t.focus()};return o.createElement("div",{className:(0,l.Z)("tabs-container",d)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":s},f)},x.map((function(e){var t=e.value,n=e.label,r=e.attributes;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:A===t?0:-1,"aria-selected":A===t,key:t,ref:function(e){return S.push(e)},onKeyDown:D,onFocus:O,onClick:O},r,{className:(0,l.Z)("tabs__item",m,null==r?void 0:r.className,{"tabs__item--active":A===t})}),null!=n?n:t)}))),r?(0,o.cloneElement)(g.filter((function(e){return e.props.value===A}))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},g.map((function(e,t){return(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==A})}))))}function k(e){var t=(0,i.Z)();return o.createElement(b,(0,a.Z)({key:String(t)},e))}var f="tabItem_Ymn6";function g(e){var t=e.children,n=e.hidden,a=e.className;return o.createElement("div",{role:"tabpanel",className:(0,l.Z)(f,a),hidden:n},t)}var x=["components"],v={title:"vite-react-extension",date:"2022-11-16 12:00:12 +0800",tags:["vite","react","sass","tailwindcss","redux","redux-observable","rxjs","observable-hooks","axios-observable"]},h=void 0,y={permalink:"/blog/2022/11/16/vite-react-extension",editUrl:"https://github.com/sayaku/sayaku.github.io/edit/main/blog/2022-11-16-vite-react-extension/index.mdx",source:"@site/blog/2022-11-16-vite-react-extension/index.mdx",title:"vite-react-extension",description:"\u7e7c\u4e0a\u4e00\u6b21vite-react\u7bc4\u672c\u8a2d\u5b9a",date:"2022-11-16T12:00:12.000Z",formattedDate:"2022\u5e7411\u670816\u65e5",tags:[{label:"vite",permalink:"/blog/tags/vite"},{label:"react",permalink:"/blog/tags/react"},{label:"sass",permalink:"/blog/tags/sass"},{label:"tailwindcss",permalink:"/blog/tags/tailwindcss"},{label:"redux",permalink:"/blog/tags/redux"},{label:"redux-observable",permalink:"/blog/tags/redux-observable"},{label:"rxjs",permalink:"/blog/tags/rxjs"},{label:"observable-hooks",permalink:"/blog/tags/observable-hooks"},{label:"axios-observable",permalink:"/blog/tags/axios-observable"}],readingTime:12.405,hasTruncateMarker:!0,authors:[],frontMatter:{title:"vite-react-extension",date:"2022-11-16 12:00:12 +0800",tags:["vite","react","sass","tailwindcss","redux","redux-observable","rxjs","observable-hooks","axios-observable"]},nextItem:{title:"MTB Hopper Lite",permalink:"/blog/2022/11/10/mtb-hopper-ramp-lite"}},N={authorsImageUrls:[]},w=[{value:"extension",id:"extension",level:2},{value:"install sass / tailwindcss 3 / postcss",id:"install-sass--tailwindcss-3--postcss",level:2},{value:"rxjs / observable-hooks",id:"rxjs--observable-hooks",level:2},{value:"redux-toolkit",id:"redux-toolkit",level:2},{value:"redux-observable / axios-observable",id:"redux-observable--axios-observable",level:2}],T={toc:w};function A(e){var t=e.components,o=(0,r.Z)(e,x);return(0,s.kt)("wrapper",(0,a.Z)({},T,o,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"\u7e7c\u4e0a\u4e00\u6b21",(0,s.kt)("a",{parentName:"p",href:"/blog/2022/11/08/build-project-react-with-vite"},"vite-react\u7bc4\u672c\u8a2d\u5b9a")),(0,s.kt)("p",null,"\u9019\u6b21\u8981\u4f86\u64f4\u5145\u9019\u500b\u7bc4\u672c"),(0,s.kt)("p",null,"\u4f5c\u6210\u6211\u5de5\u4f5c\u4e0a\u7fd2\u6163\u7684\u914d\u7f6e\u74b0\u5883"),(0,s.kt)("h2",{id:"extension"},"extension"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"sass / tailwindcss 3 / postcss"),(0,s.kt)("li",{parentName:"ul"},"rxjs / observable-hooks"),(0,s.kt)("li",{parentName:"ul"},"redux-toolkit"),(0,s.kt)("li",{parentName:"ul"},"redux-observable / axios-observable")),(0,s.kt)("p",null,"\u9996\u5148\u62c9\u4e0a\u4e00\u6b21\u5efa\u597d\u7684\u7bc4\u672c\u518d\u53e6\u5916\u505a\u4e00\u500b\u64f4\u5145\u7248\u672c\u7684\u7bc4\u672c"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx degit sayaku/reactSample viteReactTemplate\n")),(0,s.kt)("p",null,"\u4e0b\u8f09\u5f8c\u9032\u5230\u8cc7\u6599\u593e"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$ cd viteReactTemplate\n")),(0,s.kt)("h2",{id:"install-sass--tailwindcss-3--postcss"},"install sass / tailwindcss 3 / postcss"),(0,s.kt)("p",null,"\u9996\u5148\u5b89\u88dd\u8ddftailwindcss\u76f8\u95dc\u7684\u4f9d\u8cf4"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$ yarn add sass tailwindcss postcss autoprefixer --dev\n")),(0,s.kt)("p",null,"\u88dd\u5b8c\u5f8c\u521d\u59cb\u5316tailwindcss\u8207postcss\u7684\u8a2d\u5b9a\u6a94"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx tailwindcss init -p\n")),(0,s.kt)("p",null,"\u9019\u6642\u76ee\u9304\u4e0b\u6703\u591a\u5169\u500b\u8a2d\u5b9a\u6a94",(0,s.kt)("code",null,"postcss.config.cjs"),", ",(0,s.kt)("code",null,"tailwindcss.config.cjs"),"\u51fa\u4f86"),(0,s.kt)("p",null,(0,s.kt)("img",{src:n(8436).Z,width:"478",height:"456"})),(0,s.kt)("p",null,"\u5169\u500b\u6a94\u6848\u9700\u8981\u8b8a\u52d5\u5982\u4e0b"),(0,s.kt)(k,{mdxType:"Tabs"},(0,s.kt)(g,{value:"postcss.config",label:"postcss.config.cjs",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module.exports= {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n\n"))),(0,s.kt)(g,{value:"tailwindcss.config",label:"tailwindcss.config.cjs",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js",metastring:"{2-5}","{2-5}":!0},'module.exports= {\n  mode: "jit", // \u958b\u555fjit\u6a21\u5f0f\u53ef\u4ee5\u7528\u81ea\u8a02\u6578\u5b57\u4f86\u5b9a\u7fa9\u5bec\u9ad8\u6216\u9593\u8ddd\n  content: [\n    "./index.html",\n    "./src/**/*.{js,ts,jsx,tsx}",\n  ],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}\n\n')))),(0,s.kt)("p",null,"vite\u9810\u8a2d\u6703\u53bb\u627e\u6709\u6c92\u6709\u7b26\u5408postcss-load-config\u7684\u6a94\u6848\u4e26\u4e14\u53bb\u5957\u7528\u5b83"),(0,s.kt)("p",null,"\u7b26\u5408postcss-load-config\u6a94\u540d\u8207\u526f\u6a94\u540d\u53ef\u53c3\u8003:",(0,s.kt)("a",{parentName:"p",href:"https://github.com/postcss/postcss-load-config#postcssrcjs-or-postcssconfigjs"},"\u9019\u88e1")),(0,s.kt)("p",null,"postcss\u7684config\u88e1\u95dc\u65bctailwindcss\u5982\u679c\u6c92\u7279\u5225\u8a2d\u5b9a,\u9810\u8a2d\u6703\u53bb\u6293",(0,s.kt)("code",null,"tailwindcss.config")),(0,s.kt)("p",null,"\u4e5f\u5c31\u662f\u6211\u5011\u628avite\u7d66run\u8d77\u4f86\u7684\u6642\u5019\u5c31\u6703\u4e00\u8d77\u53bb\u8dd1postcss\u8207tailwindcss\u7684\u8a2d\u5b9a\u4e86"),(0,s.kt)("p",null,"vite\u8a2d\u5b9a\u771f\u7684\u5c11\u5f88\u591a\uff08\u671b\u5411webpack\u9084\u8981\u5beb\u4e00\u5806loader...\uff09"),(0,s.kt)("p",null,"\u9810\u8655\u7406css\u7684\u90e8\u5206"),(0,s.kt)("p",null,"vite\u9810\u8a2d\u6709\u652f\u63f4sass, \u4e0d\u7528\u53e6\u5916\u50cfwebpack\u4f86\u88ddsass\u7684loader, \u4f46vite\u8981\u53e6\u5916\u88ddsass\u7684\u4f9d\u8cf4\uff08\u6240\u4ee5\u6211\u5011\u4e0a\u9762\u5148\u88dd\u904esass\u4e86\uff09"),(0,s.kt)("p",null,"\u5c31\u7b97\u4f60\u4e0d\u7528sass, vite\u4e5f\u9810\u8a2d\u652f\u63f4",(0,s.kt)("code",null,"postcss-import"),"\u8207",(0,s.kt)("code",null,"postcss-nesting")),(0,s.kt)("p",null,"\u8b93\u4f60\u53ef\u4ee5\u5728css\u4e0aimport\u5176\u4ed6css\u4ee5\u53ca\u5728css\u88e1\u9762\u50cfsass\u90a3\u6a23\u80fd\u5beb\u5de2\u72c0css"),(0,s.kt)("p",null,"\u9019\u908a\u6211\u5011\u5148\u53bb\u5f15\u5165\u57fa\u672c\u7684tailwindcss"),(0,s.kt)("p",null,"\u7136\u5f8c\u5728",(0,s.kt)("code",null,"App.tsx"),"\u505a\u4e00\u4e9bclass\u7684\u4fee\u6539(\u5957\u7528tailwindcss class)"),(0,s.kt)(k,{mdxType:"Tabs"},(0,s.kt)(g,{value:"tailwind",label:"/src/style/tailwind.scss",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-css"},"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n"))),(0,s.kt)(g,{value:"index",label:"src/index.scss",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-css"},"@import 'style/tailwind';\n\n"))),(0,s.kt)(g,{value:"app",label:"src/App.tsx",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"{7-19}","{7-19}":!0},'import { useState } from "react";\nimport reactLogo from "./assets/react.svg";\n\nfunction App() {\n  const [count, setCount] = useState(0);\n\n  return (\n    <div className="flex flex-col">\n      <div className="w-full flex justify-around p-10">\n        <a href="https://vitejs.dev" target="_blank" className="basis-1/4">\n          <img src="/vite.svg" className="w-full aspect-square" alt="Vite logo" />\n        </a>\n        <a href="https://reactjs.org" target="_blank" className="basis-1/4">\n          <img src={reactLogo} className="w-full aspect-square" alt="React logo" />\n        </a>\n      </div>\n      <h1 className="self-center text-lg mx-5">Vite + React + Tailwindcss</h1>\n    </div>\n  );\n}\n\nexport default App;\n\n')))),(0,s.kt)("p",null,"\u63a5\u4e0b\u4f86\u6b63\u5f0f\u8dd1\u4e00\u4e0b"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$ yarn run dev\n")),(0,s.kt)("p",null,"\u8dd1\u8d77\u4f86\u767c\u73fe\u6211\u5011\u7684tailwindcss\u90fd\u5957\u7528\u4e0a\u53bb\u4e86"),(0,s.kt)("p",null,(0,s.kt)("img",{src:n(3201).Z,width:"2658",height:"998"})),(0,s.kt)("p",null,"\u5230\u9019\u908a\u57fa\u672c\u7684style\u7684\u90e8\u5206\u90fd\u8a2d\u5b9a\u597d\u4e86"),(0,s.kt)("h2",{id:"rxjs--observable-hooks"},"rxjs / observable-hooks"),(0,s.kt)("p",null,"\u96d6\u7136\u7c21\u55ae\u7684\u975e\u540c\u6b65\u7528Promise/async/await\u5373\u53ef\u9054\u6210"),(0,s.kt)("p",null,"\u4f46\u56e0\u70ba\u6211\u539f\u672c\u4f7f\u7528Angular, \u7528\u7fd2\u6163rxjs"),(0,s.kt)("p",null,"\u4e0d\u7528rx\u4f86\u5beb\u6574\u500b\u6e3e\u8eab\u4e0d\u5c0d\u52c1"),(0,s.kt)("p",null,"\u6240\u4ee5\u6253\u7b97\u76f4\u63a5\u5728react\u4e0a\u4f7f\u7528rx"),(0,s.kt)("p",null,"\u4e0d\u5f97\u4e0d\u8aaa\u525b\u63a5\u89f8react-hooks\u6642\u9084\u4e00\u6642\u4e0d\u77e5\u600e\u9ebc\u5728hook\u4e0a\u4f7f\u7528rx"),(0,s.kt)("p",null,"\u76f4\u5230\u4f7f\u7528observable-hooks\u5f8c\u624d\u4e86\u89e3\u539f\u4f86rx\u662f\u9019\u6a23\u5bebhooks\u7684"),(0,s.kt)("p",null,"\u800c\u5f8c\u4f86\u767c\u73fereact\u81ea\u5df1\u672c\u8eab\u7684hooks\u6709\u4e9b\u7f3a\u9677\u53ef\u4ee5\u900f\u904erx\u4f86\u89e3\u6c7a"),(0,s.kt)("p",null,"\u8209\u500b\u4f8b\u5b50\u597d\u4e86,\u5728useEffect\u88e1\u7684deps\u767c\u751f\u8b8a\u52d5\u6703\u89f8\u767cuseEffect callback"),(0,s.kt)("p",null,"\u4f46useEffect callback\u88e1\u9762\u4f60\u6703\u77e5\u9053\u662f\u54ea\u500bdeps\u767c\u751f\u6539\u8b8a\u55ce\uff1f(\u9084\u662f\u80fd\u505a\u5230\u4f46\u662f\u6c92\u90a3\u9ebc\u76f4\u89ba)"),(0,s.kt)("p",null,"\u9019\u500b\u4f8b\u5b50\u4f7f\u7528observable-hooks\u5c31\u65b9\u4fbf\u8a31\u591a"),(0,s.kt)("p",null,"\u6240\u4ee5\u6211\u5728\u4f7f\u7528react-hooks\u7684\u539f\u5247\u5c31\u662f\u80fd\u7528\u539f\u751fhooks\u5c31\u4f7f\u7528\u539f\u751f\u7684"),(0,s.kt)("p",null,"\u6bd4\u8f03\u8907\u96dc\u7684\u72c0\u614b\u63a7\u5236\u624d\u6703\u4f7f\u7528observable-hooks"),(0,s.kt)("p",null,"\u63a5\u4e0b\u4f86\u5c31\u958b\u59cb\u88ddobservable-hooks rxjs"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$yarn add observable-hooks rxjs\n")),(0,s.kt)("p",null,"\u5982\u4f55\u4f7f\u7528\u8acb\u53c3\u8003",(0,s.kt)("a",{parentName:"p",href:"https://observable-hooks.js.org/guide/#usage"},"\u5b98\u7db2"),"\u7bc4\u4f8b\uff08\u61c2\u7684\u5c31\u77e5\u9053\u600e\u9ebc\u7528\u4e86\uff09"),(0,s.kt)("h2",{id:"redux-toolkit"},"redux-toolkit"),(0,s.kt)("p",null,"\u63a5\u4e0b\u4f86\u5c31\u662f\u505a\u5168\u57df\u72c0\u614b\u7ba1\u7406"),(0,s.kt)("p",null,"\u6211\u5011\u90fd\u719f\u6089\u4f7f\u7528redux, \u4f46\u5beb\u8d77\u4f86\u5be6\u5728\u662f\u5f88\u9ebb\u7169"),(0,s.kt)("p",null,"\u6240\u4ee5\u6211\u5011\u7528redux-toolkit\u4f86\u7c21\u5316\u5bebredux\u7684\u6d41\u7a0b"),(0,s.kt)("p",null,"\u9996\u5148\u5b89\u88dd"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$yarn add @reduxjs/toolkit react-redux\n")),(0,s.kt)("p",null,"\u5efa\u7acbslice, \u9019\u88e1\u9762\u540c\u6642\u5305\u542binit state, action, reducer"),(0,s.kt)("p",null,"\u5c08\u6848\u4e0a\u662f\u5426\u8981\u628aaction, reducer\u6216\u662fepic\u5206\u6a94\u6848\u5beb\u53ef\u7531\u5718\u968a\u6c7a\u5b9a"),(0,s.kt)("p",null,"\u65b0\u589e\u8cc7\u6599\u593e\u8207\u6a94\u6848\u5982\u4e0b"),(0,s.kt)(k,{mdxType:"Tabs"},(0,s.kt)(g,{value:"todo.slice.ts",label:"store/slices/todo.slice.ts",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},'import { createAction, createSlice, PayloadAction } from "@reduxjs/toolkit";\n\nconst initialState: { count: number; name: string } = {\n  count: 0,\n  name: "sayaku",\n};\n\n// Actions\nexport const increment = createAction<number>("todo/INCREMENT");\nexport const decrement = createAction<number>("todo/DECREMENT");\n\n/**\n * Slice\n */\nexport const todoSlice = createSlice({\n  name: "todo",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder\n      .addCase(increment, (state, action: PayloadAction<number>) => {\n        return {\n          ...state,\n          count: state.count + action.payload,\n        };\n      })\n      .addCase(decrement, (state, action: PayloadAction<number>) => {\n        return {\n          ...state,\n          count: state.count - action.payload,\n        };\n      });\n  },\n});\n\n\n/**\n * Reducer\n */\n export default todoSlice.reducer;\n\n\n\n'))),(0,s.kt)(g,{value:"reducer.ts",label:"store/reducer.ts",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"import { combineReducers } from '@reduxjs/toolkit';\nimport todoReducer from './slices/todo.slice';\n\n\nconst rootReducer = combineReducers({\n  todoStore: todoReducer\n});\n\nexport default rootReducer;\n\n"))),(0,s.kt)(g,{value:"store.config.ts",label:"store/store.config.ts",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"import { configureStore } from '@reduxjs/toolkit';\nimport rootReducer from './reducers';\n\n// \u900f\u904e configureStore() \u5efa\u7acb Redux Store\nexport const store = configureStore({\n  reducer: rootReducer,\n});\n\n// type definition\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch\n\n\n"))),(0,s.kt)(g,{value:"main.tsx",label:"main.tsx",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"{5,6,10,12}","{5,6,10,12}":!0},'import React from "react";\nimport ReactDOM from "react-dom/client";\nimport App from "./App";\nimport "./index.scss";\nimport { store } from "./store/store.config";\nimport { Provider } from "react-redux";\n\nReactDOM.createRoot(document.getElementById("root") as HTMLElement).render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>\n);\n\n\n')))),(0,s.kt)("p",null,"\u57fa\u790e\u8a2d\u5b9a\u597d\u4ee5\u5f8c"),(0,s.kt)("p",null,"\u53ef\u4ee5\u958b\u59cb\u4f7f\u7528\u4e86"),(0,s.kt)("p",null,"\u4e0b\u9762\u7c21\u55ae\u4f7f\u7528\u5982\u4f55\u5f9estore\u62ff\u503c"),(0,s.kt)("p",null,"\u4ee5\u53ca\u900f\u904eObservable-hooks\u5be6\u73fe\u5728hooks\u88e1\u4f7f\u7528rx\u8207\u72c0\u614b\u7ba1\u7406"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"title=App.tsx {1-9,12-17,38-45}",title:"App.tsx","{1-9,12-17,38-45}":!0},'import {\n  useObservable,\n  useObservableState,\n} from "observable-hooks";\nimport { useDispatch, useSelector } from "react-redux";\nimport { map } from "rxjs";\nimport reactLogo from "./assets/react.svg";\nimport { decrement, increment } from "./store/slices/todo.slice";\nimport { RootState } from "./store/store.config";\n\nfunction App() {\n  const count = useSelector((state: RootState) => state.todoStore.count);\n  const dispatch = useDispatch();\n  // \u7576store\u7684count\u8b8a\u52d5\u6642\u900f\u904erx\u53bb\u5c0dcount\u505a\u8655\u7406,\u9019\u908a\u7684\u7bc4\u4f8b\u662f\u7576count\u8b8a\u52d5\u6642\u5c07count\u4e58\u4ee52\n  const twiceCount = useObservableState(\n    useObservable((obs$) => obs$.pipe(map(([v]) => v * 2)), [count])\n  );\n\n  return (\n    <div className="flex flex-col">\n      <div className="w-full flex justify-around p-10">\n        <a href="https://vitejs.dev" target="_blank" className="basis-1/4">\n          <img\n            src="/vite.svg"\n            className="w-full aspect-square"\n            alt="Vite logo"\n          />\n        </a>\n        <a href="https://reactjs.org" target="_blank" className="basis-1/4">\n          <img\n            src={reactLogo}\n            className="w-full aspect-square"\n            alt="React logo"\n          />\n        </a>\n      </div>\n      <h1 className="self-center text-lg mx-5">Vite + React + Tailwindcss</h1>\n      <div className="w-full flex justify-around p-10">\n        <div>count: {count}</div>\n        <div>twiceCount: {twiceCount}</div>\n      </div>\n      <div className="w-full flex justify-around p-10">\n        <button className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" onClick={() => dispatch(increment(1))}>increment</button>\n        <button className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" onClick={() => dispatch(decrement(1))}>decrement</button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n\n')),(0,s.kt)("p",null,"run\u8d77\u4f86\u5f8c\u61c9\u8a72\u6703\u9577\u9019\u6a23, \u53ef\u4ee5\u6b63\u5e38\u904b\u4f5c"),(0,s.kt)("p",null,(0,s.kt)("img",{src:n(5877).Z,width:"2058",height:"1236"})),(0,s.kt)("h2",{id:"redux-observable--axios-observable"},"redux-observable / axios-observable"),(0,s.kt)("p",null,"\u73fe\u5728\u5c08\u6848\u88e1\u7684Redux\u90fd\u662f\u505a\u540c\u6b65\u8655\u7406"),(0,s.kt)("p",null,"\u5982\u679c\u4eca\u5929\u8981\u52a0\u5165\u6253API\u7b49\u975e\u540c\u6b65\u8655\u7406\u96d6\u7136\u53ef\u4ee5\u900f\u904eredux-toolkit\u88e1\u7684createAsyncThunk"),(0,s.kt)("p",null,"\u4f46\u6211\u5011\u65e2\u7136\u90fd\u4f7f\u7528rx\u4e86, \u5c31\u7d71\u4e00\u90fd\u4f7f\u7528rx\u4f86\u4e32\u63a5\u975e\u540c\u6b65\u9019\u584a"),(0,s.kt)("p",null,"\u7562\u7adf\u975e\u540c\u6b65\u5c31\u662frx\u7684\u5f37\u9805"),(0,s.kt)("p",null,"\u7576\u7136\u4f60\u4e5f\u53ef\u4ee5\u5728createAsyncThunk\u88e1\u9762\u4f7f\u7528rx"),(0,s.kt)("p",null,"\u4f46\u6211\u5be6\u5728\u4e0d\u559c\u6b61\u4f7f\u7528rx\u9084\u8981\u5728\u90a3\u908a\u8f49\u6210promise\u9084\u6709async/await"),(0,s.kt)("p",null,"\u6240\u4ee5\u9019\u908a\u900f\u904eRedux Middleware\u4f86\u8655\u7406\u975e\u540c\u6b65\u9019\u4e00\u584a"),(0,s.kt)("p",null,"\u800cMiddleware\u6211\u5011\u4f7f\u7528redux-observable\u4f86\u8655\u7406\u975e\u540c\u6b65"),(0,s.kt)("p",null,"\u9996\u5148\u5b89\u88ddredux-observable"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$yarn add redux-observable -D\n")),(0,s.kt)("p",null,"\u4e4b\u5f8c\u65b0\u589e\u8207\u4fee\u6539\u4e0b\u5217\u6a94\u6848"),(0,s.kt)(k,{mdxType:"Tabs"},(0,s.kt)(g,{value:"todo.slice.ts-2",label:"store/slices/todo.slice.ts",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts",metastring:"{3,13,16,19-25}","{3,13,16,19-25}":!0},'import { createAction, createSlice, PayloadAction } from "@reduxjs/toolkit";\nimport { filter, map, mergeMap } from "rxjs";\nimport { AppEpic } from "../store.config";\n\nconst initialState: { count: number; name: string } = {\n  count: 0,\n  name: "sayaku",\n};\n\n// Actions\nexport const increment = createAction<number>("todo/INCREMENT");\nexport const decrement = createAction<number>("todo/DECREMENT");\nexport const updateName = createAction<string>("todo/UPDATE_NAME");\n\n// Async Actions\nexport const fetchData = createAction<undefined>("todo/FETCH_DATA");\n\n// Epics\nexport const fetchUserEpic: AppEpic = (action$, store, { getUserName }) =>\n  action$.pipe(\n    filter(fetchData.match),\n    mergeMap((action) =>\n      getUserName().pipe(map((response) => updateName(response.name)))\n    )\n  );\n\n/**\n * Slice\n */\nexport const todoSlice = createSlice({\n  name: "todo",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder\n      .addCase(increment, (state, action: PayloadAction<number>) => {\n        return {\n          ...state,\n          count: state.count + action.payload,\n        };\n      })\n      .addCase(decrement, (state, action: PayloadAction<number>) => {\n        return {\n          ...state,\n          count: state.count - action.payload,\n        };\n      })\n      .addCase(updateName, (state, action: PayloadAction<string>) => {\n        return {\n          ...state,\n          name: action.payload,\n        };\n      });\n  },\n});\n\n/**\n * Reducer\n */\nexport default todoSlice.reducer;\n\n'))),(0,s.kt)(g,{value:"epics",label:"store/epics.ts",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},'import { combineEpics } from "redux-observable";\nimport { fetchUserEpic as TodoFetchUserEpic } from "./slices/todo.slice";\n\nexport const rootEpic = combineEpics(TodoFetchUserEpic);\n\n\n'))),(0,s.kt)(g,{value:"fakeApi",label:"store/fakeApi.ts",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},'import { map, timer } from "rxjs";\n\nexport const fakeApi = {\n  getUserName: () =>\n    timer(2000).pipe(map(() => ({ name: "Monica" }))),\n};\n\n'))),(0,s.kt)(g,{value:"store-config",label:"store/store.config.ts",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},'import { fakeApi } from "./fakeApi";\nimport { configureStore } from "@reduxjs/toolkit";\nimport rootReducer from "./reducers";\nimport { createEpicMiddleware, Epic } from "redux-observable";\nimport { Action } from "@reduxjs/toolkit";\nimport { rootEpic } from "./epics";\n\n// type definition\nexport type AppState = ReturnType<typeof rootReducer>; // for useSelector\nexport type AppDispatch = typeof store.dispatch;\nexport type AppEpic = Epic<Action, Action, AppState, typeof fakeApi>;\n\nexport const epicMiddleware = createEpicMiddleware<\n  Action,\n  Action,\n  AppState,\n  typeof fakeApi\n>({\n  dependencies: fakeApi,\n});\n\n// \u900f\u904e configureStore() \u5efa\u7acb Redux Store\nexport const store = configureStore({\n  reducer: rootReducer,\n  middleware: (getDefaultMiddleware) => [\n    ...getDefaultMiddleware(),\n    epicMiddleware,\n  ],\n});\n\nexport type RootState = ReturnType<typeof store.getState>;\n\n// epicMiddleware\u57f7\u884c\u5fc5\u9808\u8981\u5728\u521d\u59cbstore\u4e4b\u5f8c\nepicMiddleware.run(rootEpic);\n\n\n')))),(0,s.kt)("p",null,"\u5728Redux\u88e1\u9762\u7684Middleware\u57f7\u884c\u9ede\u662fDispatch Action\u5f8c\u8207\u9032\u5230Reducer\u4e4b\u524d"),(0,s.kt)("p",null,"\u6240\u4ee5\u975e\u540c\u6b65\u7684\u52d5\u4f5c\u6211\u5011\u90fd\u6703\u5728Middleware\u88e1\u9762\u5be6\u4f5c"),(0,s.kt)("p",null,"\u6211\u5011\u9019\u908a\u975e\u540c\u6b65\u4f7f\u7528redux-observable\u88e1\u7684Epic"),(0,s.kt)("p",null,"\u9019\u500b\u5982\u679c\u5728Angular\u4e0a\u4f7f\u7528\u7684ngrx\u88e1\u662f\u76f8\u7576\u65bceffect\u7684\u89d2\u8272"),(0,s.kt)("p",null,"\u7279\u9ede\u5728\u65bcAction in Action out"),(0,s.kt)("p",null,"\u4ed6\u7684\u751f\u547d\u9031\u671f\u5927\u6982\u662f\u9019\u6a23"),(0,s.kt)("p",null,(0,s.kt)("img",{src:n(1610).Z,width:"1416",height:"953"})),(0,s.kt)("p",null,"\u56de\u5230",(0,s.kt)("code",null,"App.tsx"),"\u9019\u908a\u505a\u4fee\u6539"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"{10, 19-29}","{10,":!0,"19-29}":!0},'import { useObservable, useObservableState } from "observable-hooks";\nimport { useDispatch, useSelector } from "react-redux";\nimport { map } from "rxjs";\nimport reactLogo from "./assets/react.svg";\nimport { decrement, fetchData, increment } from "./store/slices/todo.slice";\nimport { RootState } from "./store/store.config";\n\nfunction App() {\n  const count = useSelector((state: RootState) => state.todoStore.count);\n  const name = useSelector((state: RootState) => state.todoStore.name);\n  const dispatch = useDispatch();\n  const twiceCount = useObservableState(\n    useObservable((obs$) => obs$.pipe(map(([v]) => v * 2)), [count])\n  );\n\n  return (\n    <div className="flex flex-col">\n      ...\n      <div className="w-full flex justify-around p-10">\n        <button\n          className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"\n          onClick={() => dispatch(fetchData())}\n        >\n          launch api\n        </button>\n\n        <div>name: {name}</div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n\n')),(0,s.kt)("p",null,"\u9019\u908a\u5c31\u5b8c\u6210redux\u88e1\u6253Api\u7b49\u975e\u540c\u6b65\u8655\u7406\u7684\u52d5\u4f5c\u4e86"),(0,s.kt)("p",null,"\u5728\u756b\u9762\u4e0a\u6309\u4e0blaunch api, \u5169\u79d2\u5f8c\u6703\u66f4\u65b0store, \u9810\u671f\u6703\u770b\u5230name\u5f9esayaku\u63db\u6210monica"),(0,s.kt)("p",null,"\u9019\u908a\u6211\u5011\u7684api\u662f\u505a\u5047\u7684"),(0,s.kt)("p",null,"\u800c\u5be6\u969b\u4e0a\u771f\u5be6\u8981\u6253Api\u6211\u6703\u53e6\u5916\u4f7f\u7528axios"),(0,s.kt)("p",null,"axios-observable\u5247\u662f\u4f7f\u7528rxjs\u5c07axios\u5305\u88dd\u8d77\u4f86"),(0,s.kt)("p",null,"\u540c\u6642\u4e5f\u80fd\u505a\u6514\u622a\u5668"),(0,s.kt)("p",null,"\u662f\u500b\u5f88\u65b9\u4fbf\u7684\u5957\u4ef6"),(0,s.kt)("p",null,"\u4e00\u6a23\u4e5f\u662f\u628a\u5b83\u88dd\u8d77\u4f86"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$yarn add axios axios-observable\n")),(0,s.kt)("p",null,"\u7c21\u55ae\u7684\u64cd\u4f5cGET/POST\u5982\u4e0b"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"title=GET",title:"GET"},"import Axios from  'axios-observable';\n// or const Axios = require('axios-observable').Axios;\n\n// Make a request for a user with a given ID\nAxios.get('/user?ID=12345')\n  .subscribe(\n    response => console.log(response),\n    error => console.log(error)\n  );\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"title=POST",title:"POST"},"Axios.post('/user', {\n    firstName: 'Fred',\n    lastName: 'Flintstone'\n  })\n   .subscribe(\n    response => console.log(response),\n    error => console.log(error)\n  );\n")),(0,s.kt)("p",null,"\u70ba\u4ec0\u9ebc\u4f7f\u7528rx\u7684observable\u6703\u512a\u65bcpromise"),(0,s.kt)("p",null,"\u6bd4\u5982\u4e00\u500b\u60c5\u5883"),(0,s.kt)("p",null,"\u6211\u5728\u6253API\u5931\u6557\u5f8c\u8981retry, retry\u6b21\u65783\u6b21"),(0,s.kt)("p",null,"\u4f60\u53ef\u4ee5\u60f3\u60f3\u5728promise\u7684\u5beb\u6cd5\u6703\u591a\u9ebb\u7169"),(0,s.kt)("p",null,"\u7528observable\u7684\u5beb\u6cd5\u5c31\u6703\u76f4\u89ba\u5f88\u591a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx"},"Axios.post('/user', {\n    firstName: 'Fred',\n    lastName: 'Flintstone'\n  })\n  .pipe(\n    retry(3)\n  )\n   .subscribe(\n    response => console.log(response),\n    error => console.log(error)\n  );\n")),(0,s.kt)("p",null,"\u76f8\u95dc\u529f\u80fd\u8207api\u5f88\u591a\u53ef\u4ee5\u53c3\u95b1",(0,s.kt)("a",{parentName:"p",href:"https://github.com/zhaosiyang/axios-observable#readme"},"repo")),(0,s.kt)("p",null,"\u4ee5\u4e0a\u5c31\u662f\u6211\u5de5\u4f5c\u4e0a\u57fa\u672c\u4e0a\u6703\u7528\u5230\u7684\u914d\u7f6e"),(0,s.kt)("p",null,"\u50cf\u662f\u9084\u6709\u5176\u4ed6code\u7ba1\u7406\u4f8b\u5982husky"),(0,s.kt)("p",null,"\u6216\u662f\u95dc\u65bcTesting\u7684\u90e8\u5206\u4e4b\u5f8c\u518d\u53e6\u958b\u7bc7\u5e45\u4f86\u65b0\u589e"),(0,s.kt)("p",null,"\u76ee\u524d\u7684code\u4e5f\u76f4\u63a5\u8b8a\u6210\u4e00\u500b\u65b0\u5c08\u6848\u7684\u7bc4\u672c"),(0,s.kt)("p",null,"\u4ee5\u5f8c\u76f4\u63a5\u9019\u6a23\u4e0b\u5c31\u53ef\u4ee5\u4e86"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx degit sayaku/viteReactTemplate new_react_project\n")))}A.isMDXComponent=!0},8436:function(e,t,n){t.Z=n.p+"assets/images/01-96c4b8bf9f5d61bed3fb04495d2d0695.png"},3201:function(e,t,n){t.Z=n.p+"assets/images/02-6071ef7e1afcea930c176216bc825651.png"},5877:function(e,t,n){t.Z=n.p+"assets/images/03-53756277f97d4299842f6fdb0d54a300.png"},1610:function(e,t,n){t.Z=n.p+"assets/images/04-143e39af08626cef83862d63fe0224e2.png"}}]);